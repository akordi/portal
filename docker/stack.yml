services:
  portal:    
    networks:
      - traefik_proxy
      - akordi
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.akordi-admin-portal.rule=Host(`${HOSTNAME}`)"
      - "traefik.http.routers.akordi-admin-portal.entrypoints=websecure"
      - "traefik.http.routers.akordi-admin-portal.tls.certresolver=letsencrypt"
      - "traefik.http.services.akordi-admin-portal.loadbalancer.server.port=8080"       
    image: ${DOCKER_IMAGE}
    environment:
      - API_V2_URL=http://portal-api:8080
      - API_V2_ADMIN_URL=http://admin-api:8080
      - API_SEARCH_BACKEND_URL=${API_SEARCH_BACKEND_URL}
      - API_SEARCH_KEY=${API_SEARCH_KEY}
      - PUBLIC_URL=https://${HOSTNAME}
      - GTAG_ENABLED=true
      - GTAG_ID=${GTAG_ID}
networks:
  traefik_proxy:
    external: true
  akordi:
    external: true